<html>
    <head>
        <style>
            body { 
                font-family:Arial, Helvetica, sans-serif;
            }

            .container {
                display:grid;
                grid-template-areas:
                    'calc5';
                grid-gap:1em;
            }
            div {
                text-align: left;
                animation-duration: 1s;
                animation-name: slidein;
                padding: 1em;
            }
            .myButton {
	            box-shadow:inset 0px 1px 0px 0px #caefab;
	            background:linear-gradient(to bottom, #77d42a 5%, #5cb811 100%);
	            background-color:#77d42a;
	            border-radius:6px;
	            border:1px solid #268a16;
	            display:inline-block;
	            cursor:pointer;
	            color:#306108;
	            font-family:Arial;
	            font-size:15px;
	            font-weight:bold;
	            padding:6px 24px;
	            text-decoration:none;
	            text-shadow:0px 1px 0px #aade7c;
            }
            .myButton:hover {
	            background:linear-gradient(to bottom, #5cb811 5%, #77d42a 100%);
	            background-color:#5cb811;
            }
            .myButton:active {
	            position:relative;
	            top:1px;
            }
            .calc5 {
                grid-area:calc5;
            }
            li {
                padding:.5em;
            }

            .button {
                background-color:lightblue;
                transition-duration: 0.4s;
            }

            .button:hover {
                background-color: #4CAF50; /* Green */
            }

            @keyframes slidein {
                from {
                    margin-left: 100%;
                    width: 300%; 
                 }

                to {
                    margin-left: 0%;
                    width: 100%;
                }

                
            }
        </style>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>
        
        <script>

            // Globals for DOM
            var printObj = {"LandUse":null,"value": null, "threshold":null, "screen":null};
            var control =  document.getElementById("control"); // begin and restart button

            function handleType() // changes the HTML based on what land use type is selected 
            {
                document.getElementById("myControlButton").innerHTML = "Restart";
                document.getElementById("myControlButton").setAttribute("onclick","window.location.reload()");
                var G_one = ["Residential - Single Family","Residential - MultiFamily", "Warehousing","Industrial","Office"];
                var typeChoice=document.getElementById("Type");
                var Type=typeChoice.value;
                console.log(G_one.includes(Type),Type)
                var output1=document.getElementById("Output1");
                var output2=document.getElementById("Output2");
                output1.innerHTML=" "
                output2.innerHTML=" "
                //output3.innerHTML=" "
                //report.innerHTML=" "
                if (G_one.includes(Type)){
                    output1.innerHTML=`<h4> Please follow these steps.. </h4> 
                                        <ol>
                                            <li>Search for your Project's parcel by APN or Address using the search bar in the top right of the map below</li>
                                            <li>Use the filters on the left based on your choice of Land type to filter the Screening layers</li>
                                            <li>if your project is within a GREEN AREA after turning the correct filter on, <span style="color:green;"><b>you are screened<br> 
                                            from completing a full CEQA VMT Analysis</b></span></li>
                                            <li>if it is not, continue
                                        </ol>
                                    `;
                                    if (Type == "Residential - Single Family") {
                                        output2.innerHTML=`
                                        <h4>Enter the Number of Dwelling Units </h4>
                                        <label for='pResSizeS'> Single Family: </label>
                                        <input id='pResSizeS' value type='text'><br>
                                        <input class="myButton" type="Button" onclick="evalResS()" value="Result">
                                        `;
                                    }
                                    else if (Type == "Residential - MultiFamily"){
                                        output2.innerHTML=`
                                        <label for='pResSizeM'> Multi Family: </label>
                                        <input id='pResSizeM' value type='text'><br>
                                        <input class="myButton" type="Button" onclick="evalResM()" value="Result">`
                                    }
                                    else if (Type == "Office" || Type == "Industrial" || Type == "Warehousing") {
                                        output2.innerHTML=`
                                        <label for='pKSFSizeS'> Input # of Employees traveling </label>
                                        <input id='pKSFSizeS' value type='text'><br>
                                        <input class="myButton" type="Button" onclick="evalEmp()" value="Result">
                                        `;
                                    }
                                    
                } else {
                    output1.innerHTML=`<Br>
                                        <label for='pKSFSizeS'> Input your project Size in KSF: </label>
                                        <input id='pKSFSizeS' value type='text'>
                                        <input class="myButton" type="Button" onclick="evalSqf()" value="Result">
                                        `;
                }
                printObj.LandUse = Type;
            };

            function evalResS(){ // uses the Threshold to display whether screened or not screened for Single Family Res
                var report= document.getElementById("reportOut");
                var output3=document.getElementById("Output3");
                var Threshold = (110/9.44) 
                var pResSizeS=document.getElementById("pResSizeS");
                var S_Size= parseFloat(pResSizeS.value)
                if (S_Size < Threshold){
                    output3.innerHTML="You are screened from completeing a VMT Analysis<br>";
                    output3.style.color="green";
                    printObj.screen = "Screened"
                }else{
                    output3.innerHTML="You need to Consult the County about completeing a VMT Analysis for your project"
                    output3.style.color="red";
                    printObj.screen = "Not Screened"
                }
                report.innerHTML=`
                                    use the print function in the web app to download an image of your area<br><br><input id = "image" type="file" value="Add Map"> <br><br>
                                    <input class="myButton" type="Button" onclick="printReport()" value="Report PDF">
                                    `;
                printObj.value = S_Size
                printObj.Threshold = Threshold
            };
            function evalResM(){ // uses the Threshold to display whether screened or not screened for Multi Family Res
                var output3=document.getElementById("Output3");
                var Threshold = (110/7.32)
                var pResSizeM=document.getElementById("pResSizeM");
                var M_Size= parseFloat(pResSizeM.value)
                if (M_Size < Threshold) {
                    output3.innerHTML="You are screened from completeing a VMT Analysis";
                    output3.style.color="green";
                }else{
                    output3.innerHTML="You need to Consult the County about completeing a VMT Analysis for your project";
                    output3.style.color="red";
                }
                printObj.value = M_Size
                printObj.Threshold = Threshold
            };
            
            function evalEmp(){ // uses the Threshold to display whether screened or not screened based on SQFootage
                var output3=document.getElementById("Output3");
                var pKSFSizeS=document.getElementById("pKSFSizeS");
                var KSF_Size = parseFloat(pKSFSizeS.value);
                if (Type.value == "Industrial") { // Check to see which Threshold to use
                    var Threshold = (110/3.05);
                }else if (Type.value == "Warehousing") {
                    var Threshold = (110/5.05);
                }else {
                    var Threshold = (110/3.28);
                }
                if (KSF_Size < Threshold){ // evaluate threshold
                    output3.innerHTML="You are screened from completeing a VMT Analysis";
                    output3.style.color="green";
                }else{
                    output3.innerHTML="You need to Consult the County about completeing a VMT Analysis for your project";
                    output3.style.color="red";
                }
            }
  
            function evalSqf(){
                var output3=document.getElementById("Output3");

                if (Type.value == "Winery") {
                    var Threshold = (110/45.96);
                } else {
                    var Threshold = (110/68.67);
                }
                var pKSFSizeS=document.getElementById("pKSFSizeS");
                var KSF_Size = parseFloat(pKSFSizeS.value);
                if (KSF_Size < Threshold){ // evaluate threshold
                    output3.innerHTML="You are screened from completeing a VMT Analysis";
                    output3.style.color="green";
                }else{
                    output3.innerHTML="You need to Consult the County about completeing a VMT Analysis for your project";
                    output3.style.color="red";
                }
            }
         // print page with html then send img and json to python 

         function printReport(){
            var pdf = new jsPDF('p','mm','a4');
            var image = document.getElementById("image");
            //const reader = new FileReader;

            //pdf.addImage(image.src,'PNG',50,50,180,180);
            var text = printObj.LandUse +"\n\n"+ "Value : " +printObj.value +"\n\n"+ "Threshold: "+printObj.threshold +"\n\n"+ printObj.screen;
            pdf.text(30, 30, text);
            pdf.save('Report.pdf');
         }
        </script>
    </head>
    <body>
        <div class="container">
            <div class="calc5">
                <h3>Choose your project type</h3>
                <select id="Type" onchange="handleType()">
                    <option value='Residential - Single Family'> Residential - Single Family </option>
                    <option value='Residential - MultiFamily'> Residential - MultiFamily </option>
                    <option value='Retail'> Retail </option>
                    <option value='Office'> Office </option>
                    <option value='Industrial'> Industrial </option>
                    <option value='Warehousing'> Warehousing </option>
                    <option value='Winery'> Winery </option>
                </select><br>
                <br>
                <a href="#" class="myButton" id="myControlButton" onclick="handleType()">Begin</a>
                <br>
                <div id="Output1"></div> 
                <div id="Output2"></div>
                <div id="Output3"></div>
                <div id="reportOut"></div>
            </div>
        </div>
    </body>
</html>